<app-generic-modal 
    [title]="modalTitle"
    [buttons]="modalButtons"
    [size]="event?.id && !canEdit ? 'large' : 'medium'"
    [isVisible]="true"
    (modalClosed)="onClose()">

    <ng-template #modalBody>
        <div class="event-modal-content">
            <form *ngIf="canEdit; else readOnlyView">
                <div class="form-group">
                    <label for="title">T칤tulo *</label>
                    <input
                            type="text"
                            id="title"
                            [(ngModel)]="formData.title"
                            name="title"
                            required
                            placeholder="Digite o t칤tulo do evento">
                </div>

                <div class="form-group">
                    <label for="description">Descri칞칚o *</label>
                    <textarea
                            id="description"
                            [(ngModel)]="formData.description"
                            name="description"
                            required
                            rows="4"
                            placeholder="Descreva o evento..."></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="date">Data *</label>
                        <input
                                type="date"
                                id="date"
                                [(ngModel)]="formData.date"
                                name="date"
                                required>
                    </div>

                    <div class="form-group">
                        <label for="time">Hor치rio</label>
                        <input
                                type="time"
                                id="time"
                                [(ngModel)]="formData.time"
                                name="time"
                                placeholder="HH:MM">
                    </div>

                    <div class="form-group">
                        <label for="maxParticipants">M치x. Participantes</label>
                        <input
                                type="number"
                                id="maxParticipants"
                                [(ngModel)]="formData.maxParticipants"
                                name="maxParticipants"
                                min="1"
                                placeholder="Sem limite">
                    </div>
                </div>

                <div class="form-group">
                    <label for="place">Local *</label>
                    <input
                            type="text"
                            id="place"
                            [(ngModel)]="formData.place"
                            name="place"
                            required
                            placeholder="Local do evento">
                </div>

                <div class="form-group">
                    <label for="recurrence">Repeti칞칚o</label>
                    <select
                            id="recurrence"
                            [(ngModel)]="formData.recurrence"
                            name="recurrence">
                        <option *ngFor="let option of recurrenceOptions" [value]="option.value">
                            {{ option.label }}
                        </option>
                    </select>
                </div>
            </form>

            <ng-template #readOnlyView>
                <div class="event-details">
                    <div class="detail-item">
                        <strong>T칤tulo:</strong>
                        <span>{{ event?.title }}</span>
                    </div>

                    <div class="detail-item">
                        <strong>Descri칞칚o:</strong>
                        <p>{{ event?.description }}</p>
                    </div>

                    <div class="detail-row">
                        <div class="detail-item">
                            <strong>Data:</strong>
                            <span>{{ event?.date | date:'dd/MM/yyyy' }}</span>
                        </div>

                        <div class="detail-item" *ngIf="event?.time">
                            <strong>Hor치rio:</strong>
                            <span>{{ event?.time }}</span>
                        </div>

                        <div class="detail-item" *ngIf="event?.maxParticipants">
                            <strong>M치x. Participantes:</strong>
                            <span>{{ event?.maxParticipants }}</span>
                        </div>
                    </div>

                    <div class="detail-item">
                        <strong>Local:</strong>
                        <span>{{ event?.place }}</span>
                    </div>

                    <div class="detail-item" *ngIf="event?.recurrence !== 'none'">
                        <strong>Repeti칞칚o:</strong>
                        <span>{{ getRecurrenceLabel(event?.recurrence) }}</span>
                    </div>

                    <div class="subscription-status" *ngIf="subscriptionStatus.isFull && !subscriptionStatus.isSubscribed">
                        <div class="status-badge full">
                            游뛂 Evento lotado
                        </div>
                    </div>

                    <app-participants-list
                        *ngIf="event?.id"
                        [event]="event"
                        [canEdit]="canEdit"
                        (participantRemoved)="onParticipantRemoved()">
                    </app-participants-list>
                </div>
            </ng-template>

            <!-- Loading State -->
            <div class="loading-subscription" *ngIf="isLoadingSubscription">
                <div class="loading-spinner">
                    <span>Carregando...</span>
                </div>
            </div>
        </div>
    </ng-template>
</app-generic-modal>