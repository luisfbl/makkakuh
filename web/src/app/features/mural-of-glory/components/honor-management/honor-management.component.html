<div class="honor-management">
    <div class="management-header">
        <h3>Badges Dispon√≠veis</h3>
        <button 
            *ngIf="isAdmin" 
            class="btn btn-primary create-btn"
            (click)="openCreateModal()"
            [disabled]="loading">
            <span class="btn-icon">‚ûï</span>
            Criar Badge
        </button>
    </div>

    <div class="loading-container" *ngIf="loading && honors.length === 0">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <span>Carregando badges...</span>
        </div>
    </div>

    <div class="error-message" *ngIf="error">
        <span class="error-icon">‚ö†Ô∏è</span>
        {{ error }}
        <button class="retry-btn" (click)="loadHonors()">Tentar Novamente</button>
    </div>

    <div class="honors-grid" *ngIf="!loading || honors.length > 0">
        <div class="honor-item" *ngFor="let honor of honors">
            <app-honor-badge [honor]="honor"></app-honor-badge>
            
            <div class="honor-actions" *ngIf="isAdmin">
                <button 
                    class="action-btn edit-btn"
                    (click)="openEditModal(honor)"
                    title="Editar badge"
                    [disabled]="loading">
                    ‚úèÔ∏è
                </button>
                <button 
                    class="action-btn delete-btn"
                    (click)="openDeleteModal(honor)"
                    title="Excluir badge"
                    [disabled]="loading">
                    üóëÔ∏è
                </button>
            </div>
        </div>

        <div class="empty-state" *ngIf="honors.length === 0 && !loading">
            <div class="empty-icon">üèÜ</div>
            <h4>Nenhuma badge dispon√≠vel</h4>
            <p>N√£o h√° badges cadastradas ainda.</p>
            <button 
                *ngIf="isAdmin"
                class="btn btn-primary"
                (click)="openCreateModal()">
                Criar Primeira Badge
            </button>
        </div>
    </div>

    <!-- Create Modal -->
    <app-generic-modal
        *ngIf="showCreateModal"
        title="Criar Nova Badge"
        [buttons]="createModalButtons"
        [isVisible]="showCreateModal"
        size="medium"
        (modalClosed)="closeModals()">
        
        <ng-template #modalBody>
            <div class="modal-form">
                <div class="form-group">
                    <label for="name">Nome da Badge *</label>
                    <input
                        type="text"
                        id="name"
                        [(ngModel)]="formData.name"
                        placeholder="Ex: Campe√£o de Torneio"
                        required>
                </div>

                <div class="form-group">
                    <label>√çcone da Badge</label>
                    <app-image-upload
                        (imageSelected)="onImageSelected($event)"
                        [acceptedTypes]="['image/png', 'image/jpeg', 'image/webp']"
                        [maxSizeMB]="2">
                    </app-image-upload>
                    <small class="help-text">Formatos aceitos: PNG, JPEG, WebP (m√°x. 2MB)</small>
                </div>
            </div>
        </ng-template>
    </app-generic-modal>

    <!-- Edit Modal -->
    <app-generic-modal
        *ngIf="showEditModal && selectedHonor"
        title="Editar Badge"
        [buttons]="editModalButtons"
        [isVisible]="showEditModal"
        size="medium"
        (modalClosed)="closeModals()">
        
        <ng-template #modalBody>
            <div class="modal-form">
                <div class="form-group">
                    <label for="editName">Nome da Badge *</label>
                    <input
                        type="text"
                        id="editName"
                        [(ngModel)]="formData.name"
                        placeholder="Nome da badge"
                        required>
                </div>

                <div class="form-group">
                    <label>Preview Atual</label>
                    <div class="current-badge-preview">
                        <app-honor-badge [honor]="selectedHonor"></app-honor-badge>
                    </div>
                </div>

                <div class="form-group">
                    <label>Alterar √çcone</label>
                    <app-image-upload
                        (imageSelected)="onImageSelected($event)"
                        [acceptedTypes]="['image/png', 'image/jpeg', 'image/webp']"
                        [maxSizeMB]="2">
                    </app-image-upload>
                    <small class="help-text">Deixe vazio para manter o √≠cone atual</small>
                </div>
            </div>
        </ng-template>
    </app-generic-modal>

    <!-- Delete Modal -->
    <app-generic-modal
        *ngIf="showDeleteModal && selectedHonor"
        title="Excluir Badge"
        [buttons]="deleteModalButtons"
        [isVisible]="showDeleteModal"
        size="small"
        (modalClosed)="closeModals()">
        
        <ng-template #modalBody>
            <div class="delete-confirmation">
                <div class="warning-icon">‚ö†Ô∏è</div>
                <h4>Confirmar Exclus√£o</h4>
                <p>Tem certeza que deseja excluir a badge <strong>"{{ selectedHonor.name }}"</strong>?</p>
                <p class="warning-text">Esta a√ß√£o n√£o pode ser desfeita e remover√° a badge de todos os usu√°rios que a possuem.</p>
                
                <div class="badge-preview">
                    <app-honor-badge [honor]="selectedHonor"></app-honor-badge>
                </div>
            </div>
        </ng-template>
    </app-generic-modal>
</div>